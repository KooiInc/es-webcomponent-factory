import y from"//cdn.jsdelivr.net/gh/KooiInc/es-contract-fiddler@latest/es-contract.min.js";var{contracts:l,IS:c,tryJSON:b}=y({contractsPrefix:"[Web Component creator module]"});C();function C(){l.addContracts({componentName:{method:S,reportViolationsByDefault:!0,expected({customElementName:e}={}){return[`createComponent componentName: '${e??"*no name given*"}' is not a valid custom element name!`,"See https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name"].join(`
`)}},attrChange:{method:t,defaultValue:{attributes:[],method:function(){}},expected:"onAttrChange expected {attributes: Array, method: Function}"}});function t(e){let n=c(e,Object)&&a(e?.attributes)&&c(e?.method,Function);return e&&!n&&o(),n?e:void 0;function o(){let i=c(e?.method,Function)?"Function ok":"nothing or not a Function";console.log(["\u2718 [Web Component creator module]","createComponent onAttrChange: contract for  parameters violated",`Input: { attributes: ${b(e?.attributes)}, method: ${i} }`,"Input expected: nothing or { attributes: Array[string], method: Function({input}) {...} }","Will use default: { attributes: [], method: () => {} }"].join(`
   `))}function a(i){return c(i,Array)&&i.filter(r=>c(r,String)&&!/\s/g.test(r)).length===i.length&&i||void 0}}}function S(t){let e=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"];return c(t,String)&&/\-{1,}/.test(t)&&t.toLowerCase()===t&&!e.find(n=>n===t)&&t||void 0}var m={};["a","area","audio","br","base","body","button","canvas","dl","data","datalist","div","em","fieldset","font","footer","form","hr","head","header","output","iframe","frameset","img","input","li","label","legend","link","map","mark","menu","media","meta","nav","meter","ol","object","optgroup","option","p","param","picture","pre","progress","quote","script","select","source","span","style","caption","td","col","table","tr","template","textarea","time","title","track","details","ul","video","del","ins","slot","blockquote","svg","dialog","summary","main","address","colgroup","tbody","tfoot","thead","th","dd","dt","figcaption","figure","i","b","code","h1","h2","h3","h4","abbr","bdo","dfn","kbd","q","rb","rp","rt","ruby","s","strike","samp","small","strong","sup","sub","u","var","wbr","nobr","tt","noscript"].forEach(t=>{Object.defineProperty(m,t,{get(){if(!t)return;let e=document.createElement(t)?.constructor;return e!==HTMLUnknownElement?e:void 0}})});var f=m;var u=R();function I(t){t=w(t);let{componentName:e}=t;if(l.componentName(e)&&!customElements.get(e)){let n=t.extends?.toLowerCase()?.trim(),o=f[n]??HTMLElement,a=A({forElem:o});E(a,t),!u.clientOnly&&u.report(`[factory] Registered component "${e}"`),customElements.define(e,a,{extends:n})}}function A({forElem:t}={}){let e=t;return function n(){return n.prototype=e.prototype,N(n),Reflect.construct(e,[],n)}}function N(t){if(!t.prototype.setComponentState){let e={},n=o=>o.hasAttribute("is")||/-/.test(o.tagName);Object.defineProperties(t.prototype,{myName:{get:function(){return $(this)}},state:{get:function(){return n(this)&&e[this.myName]||{}}},nth:{value:function(o){return c(o,Number,void 0)&&v(this,o)||void 0}},instanceNr:{get(){return n(this)&&getInstancePositionInDom(this)}},setComponentState:{value:function(o){if(n(this)){let a=this.myName;Object.entries(o).forEach(([i,r])=>{e[a]=e[a]??{component:this.myName},e[a][i]=r})}}}})}}function E(t,e){let{onConnect:n,onDisconnect:o,onAdopted:a,onAttrChange:i}=e,[r,d]=[i.attributes,i.method];t.observedAttributes=r,t.prototype={connectedCallback:function(){let s=this;n(s),!u.clientOnly&&u.report(`[factory] (Re)connected an instance of &lt;${s.myName}>`)},disconnectedCallback(){let s=this;!u.clientOnly&&u.report(`[factory] Removed an instance of &lt;${s.myName}>`),o(this)},adoptedCallback(){return a(this)},attributeChangedCallback(s,p,h){if(r.length)return r.find(g=>g===s)&&d(this,s,p,h),!0}}}function w(t){t.onAttrChange=l.attrChange(t.onAttrChange);let e=function(){};return t.onConnect=t.onConnect??e,t.onDisconnect=t.onDisconnect??e,t.onAdopted=t.onAdopted??e,t}function v(t,e=1){return[...t.getRootNode().querySelectorAll(t.myName)].find((n,o)=>e===o+1)}function x(){let t=new Date;return[t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()].reduce((e,n,o)=>`${e}${o<3?":":"."}${`${n}`.padStart(o<3?2:3,"0")}`,"").slice(1)}function $(t){let e=t.getAttribute("is");return`${t.tagName.toLowerCase()}${e?`[is='${e}']`:""}`}function L(t,e={mode:"open"}){let n=t.shadowRoot;return n||t.attachShadow(e)}function O(t,e){if(t.state.styling)return t.state.styling;e=e.startsWith("#")?document.querySelector(e).content.querySelector("style").textContent:e,u.report(`[client] Storing embedded style for &lt;${t.myName}>`);let n=new CSSStyleSheet;return n.replaceSync(e),t.setComponentState({styling:n}),t.state.styling}function R(){let t={"&lt;":"<","&gt;":">"},e=!1,n=function(r){console.info(`\u2714 ${r.replaceAll(/&lt;|&gt;/g,d=>t[d])}`)},o=n,a=function(){},i=!1;return{on(){e=!0},off(){e=!1},get now(){return x},set clientOnly(r){i=c(r,Boolean)&&r||!1},get clientOnly(){return i},set report(r){o=r||n},get report(){return e&&o||a}}}export{L as createOrRetrieveShadowRoot,I as default,u as reporter,O as setComponentStyleFor};
